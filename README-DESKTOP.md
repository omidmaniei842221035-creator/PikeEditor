# راهنمای ساخت و نصب نرم‌افزار دسکتاپی

این راهنما نحوه ساخت فایل نصبی (installer) برای نسخه دسکتاپ سامانه مانیتورینگ هوشمند پایانه‌های فروشگاهی را توضیح می‌دهد.

## 📋 پیش‌نیازها

قبل از شروع، اطمینان حاصل کنید که موارد زیر را نصب کرده‌اید:

1. **Node.js** (نسخه 18 یا بالاتر)
   - دانلود از: https://nodejs.org/

2. **Git** (اختیاری، برای کلون کردن پروژه)
   - دانلود از: https://git-scm.com/

## 🚀 مراحل ساخت نرم‌افزار دسکتاپی

### مرحله 1: آماده‌سازی پروژه

```bash
# نصب وابستگی‌ها
npm install

# بررسی نصب درست Electron
npm list electron electron-builder
```

### مرحله 2: ساخت فایل‌های برنامه

برای ساخت کامل نرم‌افزار دسکتاپی:

```bash
# ساخت نسخه ویندوزی (فایل .exe نصبی)
npm run electron:build:win
```

این دستور:
1. ✅ فایل‌های React را build می‌کند (frontend)
2. ✅ سرور Express را bundle می‌کند (backend)
3. ✅ فایل‌های Electron را compile می‌کند
4. ✅ یک installer ویندوزی (.exe) می‌سازد

### مرحله 3: یافتن فایل نصبی

پس از اتمام build، فایل نصبی در پوشه زیر قرار دارد:

```
release/
  └── سامانه مانیتورینگ POS-1.0.0-Setup.exe
```

## 💾 ویژگی‌های نسخه دسکتاپی

### دیتابیس محلی (SQLite)
- ✅ تمام داده‌ها به صورت محلی ذخیره می‌شوند
- ✅ نیازی به اتصال به اینترنت نیست
- ✅ فایل دیتابیس در مسیر زیر قرار دارد:
  ```
  %APPDATA%/سامانه مانیتورینگ POS/pos-system.db
  ```

### قابلیت‌های نصب
- ✅ نصب در پوشه دلخواه
- ✅ ایجاد شورتکات روی دسکتاپ
- ✅ اضافه شدن به Start Menu

## 🔧 دستورات توسعه

### اجرای نسخه توسعه Electron

```bash
# اجرای وب‌سرور (در یک ترمینال)
npm run dev

# اجرای Electron (در ترمینال دیگر)
npm run electron:dev
```

### ساخت بدون installer (برای تست)

```bash
npm run pack
```

این دستور فایل‌های برنامه را بدون ساخت installer آماده می‌کند.

## 📦 سایر پلتفرم‌ها

### ساخت برای macOS

```bash
npm run electron:build -- --mac
```

### ساخت برای Linux

```bash
npm run electron:build -- --linux
```

## 🎨 سفارشی‌سازی

### تغییر آیکون برنامه

1. یک فایل آیکون `.ico` (256x256 پیکسل) آماده کنید
2. فایل را در پوشه `build/` با نام `icon.ico` قرار دهید
3. در `package.json`، خط زیر را اضافه کنید:

```json
"win": {
  "icon": "build/icon.ico",
  ...
}
```

### تغییر نام نرم‌افزار

در `package.json`:

```json
{
  "name": "pos-monitoring-system",
  "productName": "نام دلخواه شما",
  "description": "توضیحات دلخواه",
  ...
}
```

## 🔄 بک‌آپ و بازیابی

### گرفتن بک‌آپ از نسخه وب

1. در نسخه وب، به بخش "پشتیبان‌گیری و بازیابی" بروید
2. روی "دانلود فایل بک‌آپ" کلیک کنید
3. فایل JSON ذخیره می‌شود

### بازیابی در نسخه دسکتاپ

1. نرم‌افزار دسکتاپ را باز کنید
2. به بخش "پشتیبان‌گیری و بازیابی" بروید
3. فایل JSON را آپلود و بازیابی کنید

## ⚠️ نکات مهم

### محدودیت‌ها

1. **فایل‌های بزرگ**: نرم‌افزار نهایی حدود 150-200 مگابایت خواهد بود
2. **ویندوز 10+**: نیاز به ویندوز 10 یا بالاتر دارد
3. **حافظه**: حداقل 4GB RAM توصیه می‌شود

### رفع مشکلات رایج

#### خطا در build:
```bash
# پاک کردن فایل‌های قبلی
rm -rf dist dist-electron release
npm run electron:build:win
```

#### نرم‌افزار باز نمی‌شود:
- از ویندوز Defender یا آنتی‌ویروس استثنا بگیرید
- با دسترسی Administrator اجرا کنید

#### دیتابیس خالی است:
- از بخش بازیابی فایل بک‌آپ را import کنید
- یا داده‌های جدید وارد کنید

## 📚 منابع

- [مستندات Electron](https://www.electronjs.org/docs)
- [مستندات Electron Builder](https://www.electron.build/)
- [مستندات Drizzle ORM](https://orm.drizzle.team/)

## 🆘 پشتیبانی

در صورت بروز مشکل:
1. لاگ‌های کنسول را بررسی کنید
2. در بخش Issues پروژه مشکل را گزارش دهید
3. فایل دیتابیس را بک‌آپ بگیرید

---

## 🔐 امنیت

- تمام داده‌ها به صورت محلی ذخیره می‌شوند
- نیازی به اتصال به سرور خارجی نیست
- اطلاعات رمز عبور به صورت hash شده ذخیره می‌شوند

## 📝 لایسنس

این نرم‌افزار تحت لایسنس MIT منتشر شده است.
